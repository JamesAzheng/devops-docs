# IP 概述

- IP地址用来标识网络中每台主机（计算机、网络设备、外围设备）的地址；
- 公网IP地址全球唯一，局域网IP局域网内唯一；
- 每个网段就是一个广播域；



# IP 相关注意事项

**IP 冲突：**

IP 冲突指的是两台或多台计算机在同一网络中使用相同的 IP 地址。这种情况会导致网络中的通信出现问题，并可能导致以下后果：

1. 通信错误：如果两个或多个设备在同一网络中使用相同的 IP 地址，则网络上的数据包可能会被路由到错误的设备，这将导致通信错误和数据包的丢失。
2. 网络故障：如果两个或多个设备在同一网络中使用相同的 IP 地址，则可能会导致网络故障，例如无法连接到 Internet 或无法访问本地网络上的其他设备。
3. 安全问题：IP 地址冲突可能导致网络安全问题，例如黑客可以利用这种情况来攻击网络中的其他设备。
4. 远程访问问题：如果两个或多个设备在同一网络中使用相同的 IP 地址，则远程访问将无法正常工作。例如，如果两个计算机都在同一网络上使用相同的 IP 地址，则无法通过远程桌面连接到这些计算机中的任何一个。

为避免 IP 地址冲突，需要在网络中使用唯一的 IP 地址，并在添加新设备时检查网络中是否已经有该 IP 地址的设备。此外，可以采用 DHCP（动态主机配置协议）来自动分配 IP 地址，以确保网络中不会出现重复的 IP 地址。



# IP地址的组成

IP地址由两部分组成：

- **网络ID：**表示网络，每个网段分配一个网络ID，处于高位（班级编号）
- **主机ID：**表示单个主机，由组织分配给各设备，处于低位（学生编号）





# 子网掩码

- 子网掩码用于标明网络IP位和主机ID位；为1表示网络ID；为0表示主机ID

**子网掩码速算：**

```bash
00000000 #0
10000000 #128
11000000 #192
11100000 #224
11110000 #240
11111000 #248
11111100 #252
11111110 #254
11111111 #255
```



**公网IP地址还需要子网掩码吗**

是的，公网IP地址仍然需要子网掩码。子网掩码用于划分一个网络中的主机和子网。在公共互联网中，子网掩码通常是由网络管理员或互联网服务提供商（ISP）指定的，以便将公共IP地址划分为更小的网络。这有助于提高网络的安全性和性能，并使网络管理员能够更有效地管理其网络。因此，即使是公共IP地址，也需要使用子网掩码来确定主机所在的网络和其他相关信息。



**所有子网掩码可容纳的主机数量**

子网掩码的长度决定了它所能容纳的主机数量。下面列出了所有可能的子网掩码长度及其所能容纳的主机数量：

- /1 子网掩码：2,147,483,646 个主机
- /2 子网掩码：1,073,741,822 个主机
- /3 子网掩码：536,870,910 个主机
- /4 子网掩码：268,435,454 个主机
- /5 子网掩码：134,217,726 个主机
- /6 子网掩码：67,108,862 个主机
- /7 子网掩码：33,554,430 个主机
- /8 子网掩码：16,777,214 个主机
- /9 子网掩码：8,388,606 个主机
- /10 子网掩码：4,194,302 个主机
- /11 子网掩码：2,097,150 个主机
- /12 子网掩码：1,048,574 个主机
- /13 子网掩码：524,286 个主机
- /14 子网掩码：262,142 个主机
- /15 子网掩码：131,070 个主机
- /16 子网掩码：65,534 个主机
- /17 子网掩码：32,766 个主机
- /18 子网掩码：16,382 个主机
- /19 子网掩码：8,190 个主机
- /20 子网掩码：4,094 个主机
- /21 子网掩码：2,046 个主机
- /22 子网掩码：1,022 个主机
- /23 子网掩码：510 个主机
- /24 子网掩码：254 个主机
- /25 子网掩码：126 个主机
- /26 子网掩码：62 个主机
- /27 子网掩码：30 个主机
- /28 子网掩码：14 个主机
- /29 子网掩码：6 个主机
- /30 子网掩码：2 个主机

需要注意的是，每个网络至少需要两个IP地址，一个用于网络地址，一个用于广播地址，因此实际可用的主机IP地址数量比上述数字少2个。



# 公网IP地址分类

## A类：

- 网络ID位是最高8位 主机ID是24位低位

- 0 0000000 ~ 0 1111111.X.Y.Z : 
  - 0-127.X.Y.Z
- 地址范围：
  - 1.0.0.1-126.255.255.254

- 网络数：
  - 126=2^7(可变的网络ID位数) - 2(减2是因为要减去0和127这两个特殊地址)
- 每个网络中的主机数：
  - 2^24-2=16777214（-2是减去主机ID位全为0和全位1的地址，全为0表示一个网段、全为1表示子网广播地址）
- 默认子网掩码：
  - 255.0.0.0
- 私网地址：
  - 10.0.0.0
- 范例:
  - 114.114.114.114
  - 8.8.8.8
  - 1.1.1.1
  - 58.87.87.99
  - 119.29.29.29

## B类：

- 网络ID位是最高16位 主机ID是16位低位

- 10 000000 - 10 111111.X.Y.Z：
  - 128-191.X.Y.Z
- 地址范围：
  - 128.1.0.1-191.254.255.254
- 网络数：
  - 2^14=16384
- 每个网络中的主机数：
  - 2^16-2=65534
- 默认子网掩码：
  - 255.255.0.0
- 私网地址：
  - 172.16.0.0-172.31.0.0
- 范例:
  - 180.76.76.76
  - 172.16.0.1

## C类：

- 网络ID位是最高24位,主机ID是8位低位

- 110 0 0000 - 110 1 1111.X.Y.Z: 
  - 192-223.X.Y.Z
- 地址范围：
  - 192.0.1.1-223.255.254.254
- 网络数：
  - 2^21=2097152
- 每个网络中的主机数：
  - 2^8-2=254
- 默认子网掩码：
  - 255.255.255.0
- 私网地址：
  - 192.168.0.0 ~ 192.168.255.0
- 范例: 
  - 223.6.6.6

## D类：

- 组（多）播

- 1110 0000 - 1110 1111.X.Y.Z: 
  - 224-239.X.Y.Z

## E类：

- 保留未使用

- 240-255



# 局域网IP地址分类

不会在互联网上分配，留给局域网使用

## A类：

- 10.0.0.0—10.255.255.255；CIDR表示法：10.0.0.0/8

## B类：

- 172.16.0.0---172.31.255.555；CIDR表示法：172.16.0.0/12；子网掩码是255.240.0.0

## C类：

- 192.168.0.0---192.168.255.255；CIDR表示法：192.168.0.0/16







# 公共IP地址

**A类**：

- 1.0.0.0 ~ 9.255.255.255
- 11.0.0.0 ~ 126.255.255.255

**B类**：

- 128.0.0.0 ~ 172.15.255.255
- 172.32.0.0 ~ 191.255.255.255

**C类**：

- 192.0.0.0 ~ 192.167.255.255
- 192.169.0.0 ~ 223.255.255.255



# 特殊IP地址

**所有IP地址：**

- 0.0.0.0

**广播地址：**

- 255.255.255.255
- 指本网段内(同一广播域)的所有主机

**回环地址：**

- 127.0.0.1~127.255.255.254
- 本机回环地址，主要用于测试。在传输介质上永远不应该出现目的地址为“127.0.0.1”的 数据包

**组(多)播地址：**

- 地址范围：224.0.0.1-239.255.255.254
- 224.0.0.1特指所有主机，224.0.0.2特指所有路由器。224.0.0.5指OSPF 路由器，地址多用于一些特定的程序以及多媒体程序

**保留未使用的地址：**

- 地址范围：240.0.0.0-255.255.255.254







# 子网

- 子网表示...

**子网数计算公式：**

- 2^可变网络ID位数

**子网中主机数量计算公式：**

- 2^主机ID的位数-2
  - -2是因为减去了全为0和全为1的地址，全为0表示一个子网，全为1表示子网中的广播地址



# 网络ID

- 网络ID可以判断当前主机在哪个网段；
- 网络ID相同 则属于同一网段；

**网络ID计算公式：**

- IP^(与)netmask=网络ID

- 范例：

  - 假设IP 172.26.130.198/12；十进制子网掩码为 255.240.0.0

  - ```sh
    10101100.00011010.10000010.11000110 # IP转化成二进制
    11111111.11110000.00000000.00000000 # 子网掩码转化成二进制
    10101100.00010000.00000000.00000000 # 得到网络ID为172.16.0.0（和1相与保留原值，和0相与都为0）
    ```

**判断与对方是否在同一网段：**

1. 先用自己的IP和自己的子网掩码相与(从而得到自己的网络ID)；
2. 在用对方的IP和自己的子网掩码相与(判断对方和自己的子网掩码相与后是否与自己的网络ID是否相同)；
3. 得到的网络ID相同则表示在同一个网段，反之则不在一个同一个网段。

**与运算：**

```bash
0^0=0
1^0=0
#任何数和0相与都为0

0^1=0
1^1=1
#任何数和1相与结果为原值
```







# 二次方速算

```bash
2    #2
2^2  #4
2^3  #8
2^4  #16
2^5  #32
2^6  #64
2^7  #128
2^8  #256
2^9  #512
2^10 #1024
2^11 #2048
2^12 #4096
```



# 二进制速算

```bash
00000000  #0
0000000 1 #1
000000 10 #2
00000 100 #4
0000 1000 #8
000 10000 #16
00 100000 #32
0 1000000 #64
1 0000000 #128
11 000000 #192
111 00000 #224
1111 0000 #240
11111 000 #248
111111 00 #252
1111111 0 #254
11111111  #255
```



# 划分子网

将大网划分成若干个小网，网络ID向主机ID借N位，可以划分位2^N个子网





# 合并超网

- 若干个小网合并成一个大网，合并超网通常是为了优化路由表
- 主机ID向网络ID借位



# 练习题

**已知IP 172.16.1.100/28，请计算出：**

1. 此主机所在的网段中有多少主机 
2. 网络ID
3. 此网段中最小IP和最大IP
3. 此网段中的广播地址

```bash
#答：

14 # 主机数量
172.16.1.96 # 网络ID
172.16.1.97 # 最小IP
172.16.1.110 # 最大IP
172.16.1.111 # 广播地址
```

**已知IP 203.110.228.200/28，请计算出：**

1. 此主机所在的网段中有多少主机 
2. 网络ID
3. 此网段中最小IP和最大IP
3. 此网段中的广播地址

```bash
#答：

14 # 主机数量
203.110.228.192 # 网络ID
203.110.228.193 # 最小IP
203.110.228.206 # 最大IP
```

**中国移动10.0.0.0/8 给32个各省公司划分对应的子网**

```BASH
#1）每个省公司的子网的netmask？
10.0.0.0/13 即 255.248.0.0 #因为2^5=32 10.00000 000.0.0

#2）每个省公司的子网的主机数有多少？
32-13=19
2^19-2=524286 #524286个主机

#3）河南省得到第9个子网，网络ID？
10.80.0.0/13 #因为10.01010 000.0.0

#4）河南省得到第9个子网的最小IP和最大的IP？
10.80.0.1/13 #最小IP
10.87.255.254/13 #最大IP

#5）所有子网中最大，最小的子网的netid？
10.248.0.0 #最大
10.0.0.0 #最小

#6）洛阳市第2个子网，最小IP和最大IP？
10.16.0.1 #最小IP
10.23.255.254 #最大IP
```

**中国移动10.0.0.0/8 给32个各省公司划分对应的子网,河南省得到第10个子网,再给省内的16个地市划分子网**

```bash
#1）每个市公司的子网的netmask？

#2）每个市公司的子网的主机数有多少？

#3）各地市的最小netid和最大的netid？

#4）洛阳市第2个子网，最小IP和最大IP？
```







# ip v6

IPv6地址是128位长的地址，相比IPv4的32位地址，IPv6提供了更大的地址空间。IPv6地址的一般形式是八组四个十六进制数字，每组之间用冒号分隔。以下是一些常见的IPv6地址类型：

1. **未指定地址（Unspecified Address）**：全零的地址，表示没有指定具体的地址。在IPv6中用 `::` 表示，类似于IPv4中的 `0.0.0.0`。

   示例：`::`

2. **回环地址（Loopback Address）**：用于本地主机回环测试，类似于IPv4中的 `127.0.0.1`。在IPv6中用 `::1` 表示。

   示例：`::1`

3. **链路本地地址（Link-Local Address）**：仅在特定链路（网络段）上有效，用于设备之间的直连通信。通常以 `fe80::` 开头。

   示例：`fe80::`

4. **站点本地地址（Site-Local Address）**：在一个站点（网络）上有效，但不会随机器的移动而改变。在IPv6中，站点本地地址已被弃用，推荐使用全局唯一地址。

5. **全球唯一地址（Global Unicast Address）**：全球唯一的IPv6地址，用于在全球范围内唯一标识设备。通常以 `2xxx:` 开头。

   示例：`2001:0db8::`

   **2408:400a:ed:6800:202f:8169:542:84fc/128 这是我的公网地址，详细解释下其含义** 

   IPv6地址 `2408:400a:ed:6800:202f:8169:542:84fc/128` 是一个包含网络前缀和子网掩码长度（CIDR notation）的IPv6地址。让我们逐个解释：

   - `2408:400a:ed:6800:202f:8169:542:84fc`：这是IPv6的具体地址部分，由八组四个十六进制数字构成，共128位。这是你的具体IPv6地址，用于唯一标识你所在的设备或网络。

   - `/128`：这表示子网掩码的长度。在IPv6中，每个地址块都有128位，因此 `/128` 表示这是一个具有完整128位的单一主机地址，没有子网划分。

   这个地址是一个全球唯一的IPv6地址，用于标识你所在的设备或网络。IPv6的地址空间非常庞大，提供了远超过IPv4的地址数量，以满足互联网中不断增长的需求。IPv6的地址表示更为简洁，并且可以支持更多的设备和服务。

6. **组播地址（Multicast Address）**：用于多播通信，可以一对多传输数据。通常以 `ff00::` 开头。

   示例：`ff02::1`（所有节点组播地址）

这些地址类型在IPv6中有不同的用途和范围，其中全球唯一地址用于在整个互联网上唯一标识设备，而链路本地地址用于直连通信等。
