# Wireshark 过滤器

## 过滤器语法

```sh
# 协议
ip、tcp、eth...

# 源
src

# 目标
dst

# 端口
port

# 比较运算符
等于（==）、不等于（!=）、大于（>）、小于（<）、大于等于（>=）、小于等于（<=）等。

# 括号
使用括号可以改变运算符的优先级，也可以更清楚地指定逻辑关系。


# 逻辑运算符
and、&&
or、||
not、!
```

### 逻辑运算符

使用关键词进行逻辑运算：

```
http and ip.src == 10.200.66.64
http or tcp.port == 80
not ip.dst == 192.168.0.1
```

使用标准逻辑运算符进行逻辑运算：

```
http && ip.src == 10.200.66.64
http || tcp.port == 80
!ip.dst == 192.168.0.1
```

你可以根据个人偏好选择使用哪种形式，它们在过滤器语法中是等效的。

请注意，这些逻辑运算符的优先级与标准的布尔逻辑运算符相同，`!` 具有最高优先级，接着是 `&&`，最后是 `||`。如果有需要，你可以使用括号来明确运算的优先级。

感谢指出这一点，我为之前的回答所带来的混淆表示歉意。如果你还有其他问题，请随时提问。



以下是一些示例，以帮助理解 Wireshark 过滤器语法：

- 显示目标端口号为 80 或 443 的数据包： `tcp.dstport == 80 or tcp.dstport == 443`
- 显示源 IP 地址不是本地子网的数据包： `ip.src != 192.168.0.0/24`
- 显示源 IP 地址为 192.168.0.1 且目标端口号为 22 的数据包： `ip.src == 192.168.0.1 and tcp.dstport == 22`
- 





## 过滤 MAC 地址

```sh
# 过滤 MAC 地址为 d4:5d:64:ca:82:30 的数据包
eth.addr == d4:5d:64:ca:82:30


# 过滤源 MAC 地址为 d4:5d:64:ca:82:30 的数据包
eth.src == d4:5d:64:ca:82:30


# 过滤目标 MAC 地址为 d4:5d:64:ca:82:30 的数据包
eth.dst == d4:5d:64:ca:82:30
```



## 过滤 IP 地址

```sh
# 过滤 IP 地址为 154.39.99.25 的数据包
ip.addr == 154.39.99.25


# 过滤源 IP 地址为 154.39.99.25 的数据包
ip.src == 154.39.99.25


# 过滤目标 IP 地址为 154.39.99.25 的数据包
ip.dst == 154.39.99.25


# 过滤源 IP 地址为 192.168.0.1，目标 IP 地址为 192.168.0.2 的数据包
ip.src == 10.200.66.64 && ip.dst == 10.200.66.1
```



## 过滤端口

```sh
# 过滤 TCP 端口号为 80 的数据包
tcp.port == 80


# 过滤 UDP 端口号为 53 的数据包
udp.port == 53
```



## 过滤协议

使用协议字段名作为过滤条件，例如 `tcp`、`udp`、`http` 等。这将显示与指定协议匹配的所有数据包。

```sh
# 显示所有的 TCP 数据包
tcp


# 显示不是 TCP 协议的数据包
not tcp`


# 显示所有的 DNS 数据包
dns


# 显示所有的 HTTP 数据包
http


# 显示所有的 HTTP 请求数据包
http.request


# 显示源 IP 地址为 192.168.0.1 的所有 TCP 数据包
tcp and ip.src == 192.168.0.1


# 显示源 IP 地址为 192.168.0.1 的所有 HTTP 数据包
http && ip.src == 10.200.66.64


# 显示目标端口为 53（DNS）的 UDP 数据包
udp and udp.dstport == 53
```



1. 使用特定的协议过滤器：Wireshark 提供了一些特定协议的过滤器，可以更方便地过滤指定协议的数据包。这些过滤器在过滤栏中的下拉菜单中提供。

示例：显示所有的 DNS 数据包，使用 DNS 过滤器

```
Copy code

```

示例：显示所有的 HTTP 数据包，使用 HTTP 过滤器

```
Copy code

```

以上是几种过滤指定协议的方法，你可以根据需要选择适合的方法进行过滤。请注意，过滤器的语法和可用的协议字段可能因 Wireshark 版本而有所不同。可以参考 Wireshark 的官方文档或其他网络资源获取更详细的信息和示例。





http && ip.src == 10.200.66.64



ChatGPT



这个过滤器 `http && ip.src == 10.200.66.64` 的意思是筛选满足以下两个条件的数据包：

1. 数据包使用 HTTP 协议（即是 HTTP 数据包）。
2. 数据包的源 IP 地址是 10.200.66.64。

这样的过滤器将显示源 IP 地址为 10.200.66.64 的所有 HTTP 数据包。你可以将这个过滤器应用于 Wireshark 中的过滤栏，以便只显示符合这两个条件的数据包。

## 其它

### 过滤特定协议

过滤特定协议，可以使用过滤器 "ip.proto"，后跟需要过滤的协议号。

- 例如，要过滤 ICMP 协议的数据包，可以使用以下过滤器：

```
ip.proto == 1
```



### 过滤特定协议并指定端口

过滤特定协议并指定端口，可以组合使用 "ip.proto" 和 "tcp.port" 或 "udp.port" 过滤器。

- 例如，要过滤 TCP 协议的端口号为 80 的数据包，可以使用以下过滤器

```
ip.proto == 6 && tcp.port == 80
```





### 过滤特定协议的数据包长度

过滤特定协议的数据包长度，可以使用过滤器 "frame.len"，后跟需要过滤的数据包长度。

- 例如，要过滤长度为 100 字节的 ICMP 数据包，可以使用以下过滤器：

```
ip.proto == 1 && frame.len == 100
```



### 过滤特定协议的数据包并指定源或目标 IP 地址

过滤特定协议的数据包并指定源或目标 IP 地址，可以组合使用 "ip.proto" 和 "ip.src" 或 "ip.dst" 过滤器。

- 例如，要过滤 TCP 协议的源 IP 地址为 192.168.0.1 的数据包，可以使用以下过滤器：

```
ip.proto == 6 && ip.src == 192.168.0.1
```



### 过滤特定协议的数据包并指定源或目标端口

过滤特定协议的数据包并指定源或目标端口，可以组合使用 "ip.proto" 和 "tcp.srcport" 或 "tcp.dstport" 过滤器。

- 例如，要过滤 UDP 协议的目标端口号为 53 的数据包，可以使用以下过滤器：

```
ip.proto == 17 && udp.dstport == 53
```



### 过滤特定协议的数据包并指定源和目标 IP 地址

过滤特定协议的数据包并指定源和目标 IP 地址，可以组合使用 "ip.proto"、"ip.src" 和 "ip.dst" 过滤器。

- 例如，要过滤 TCP 协议的源 IP 地址为 192.168.0.1，目标 IP 地址为 192.168.0.2 的数据包，可以使用以下过滤器：

```
ip.proto == 6 && ip.src == 192.168.0.1 && ip.dst == 192.168.0.2
```



### 过滤特定协议的数据包并指定源和目标端口

过滤特定协议的数据包并指定源和目标端口，可以组合使用 "ip.proto"、"tcp.srcport" 和 "tcp.dstport" 过滤器。

- 例如，要过滤 TCP 协议的源端口号为 12345，目标端口号为 80 的数据包，可以使用以下过滤器：

```
ip.proto == 6 && tcp.srcport == 12345 && tcp.dstport == 80
```



### 过滤特定协议的数据包并指定数据包内容

过滤特定协议的数据包并指定数据包内容，可以使用过滤器 "data"，后跟需要过滤的数据包内容。

- 例如，要过滤 HTTP 请求中包含 "login" 字符串的数据包，可以使用以下过滤器：

```
ip.proto == 6 && tcp.port == 80 && data contains "login"
```







# Wireshark 追踪流

Wireshark 中的"追踪流"（Follow Stream）功能是一种便捷的方法，用于查看特定网络连接的完整通信内容。通过追踪流，你可以轻松地获取与该连接相关的所有数据包，并将它们组合在一起，以便更方便地分析和查看。

以下是使用 Wireshark 的追踪流功能的步骤：

1. 首先，选择一个包含你感兴趣的连接的数据包。你可以使用过滤器来筛选出特定的连接或会话。例如，你可以使用过滤器 `ip.addr == <源IP> && ip.addr == <目标IP>` 来过滤源 IP 和目标 IP 地址匹配的数据包。
2. 选中这个数据包，然后右击该数据包，并选择菜单中的"Follow"（或"Follow TCP Stream"、"Follow UDP Stream"，具体取决于协议类型）。
3. 一个新的窗口将打开，其中包含了与该连接相关的所有数据包的内容。这个窗口将显示整个流中的请求和响应，以及相应的数据。
4. 在追踪流窗口中，你可以直接查看连接的请求和响应的内容，包括 HTTP 报文、TCP 数据等。你可以选择文本模式或十六进制模式来查看数据。

通过追踪流功能，你可以更清晰地了解特定连接的通信内容，帮助你进行协议分析、问题排查等。你可以查看请求和响应之间的交互，检查数据的完整性、协议头部信息等。

需要注意的是，追踪流功能在处理大量数据包时可能会导致性能问题，特别是对于大型文件或长时间的数据流。在这种情况下，使用过滤器和其他分析功能可能更加有效。

