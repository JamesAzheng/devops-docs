# 交换机概述

- 交换机属于局域网设备，处于OSI七层参考模型的数据链路层（属于典型的二层设备）

- 交换机中有一块RAM芯片，其中记录了交换机接口和计算机mac地址的对应关系

**交换机的主要功能：**

- 将多台设备连接起来组成局域网

- **交换机可以隔断冲突域**（交换机在转发帧之前必须执行 CSMA/CD 算法，若在发送过程中出现碰撞，就必须停止发送和进行退避，所以交换机能隔断冲突域）
- **交换机不能隔断广播域**（但可以通过划分vlan的方式隔断广播域）
- 交换机的每个端口可以提供专用的带宽
- 支持全双工

**工作原理：**

- 交换机根据收到数据帧中的源MAC地址建立该地址同交换机的端口映射，并将其写入Mac地址表中
  - 源mac地址 **<-->** 交换机某一端口（建立映射关系）
- 交换机将数据帧中目的MAC地址同已建立的MAC地址表进行比较，已决定由哪个端口进行转发
- 如数据帧中的目的MAC地址不在MAC地址表中，则向所有端口转发（这一过程称为泛洪 flood），转发成功后交换机会学习到目标地址的MAC和交换机端口的对应关系 并写入到RAM芯片中 以便下一次转发之间通过该表中的MAC与交换机端口的对应关系来进行转发
- 广播帧和组播帧向所有的端口转发



硬件交换机（Hardware Switch）是一种数据通信设备，能够在网络中转发数据包。硬件交换机具有高速、低延迟、低丢包率等优点，因此在大规模的局域网、数据中心等场景中被广泛应用。下面是硬件交换机的详解：

1. 工作原理：硬件交换机通过查找目标MAC地址来转发数据包，每个交换机都有一个MAC地址表，用于存储MAC地址与端口的对应关系。当一个数据包到达交换机时，交换机会查找目标MAC地址，如果MAC地址表中存在对应关系，则直接转发到相应的端口；如果不存在，则向所有端口广播数据包，同时更新MAC地址表。
2. 端口类型：硬件交换机有不同类型的端口，如普通端口、上行端口、堆叠端口等。普通端口用于连接终端设备，上行端口用于连接其他交换机或路由器，堆叠端口用于连接同型号的交换机形成堆叠。
3. VLAN支持：硬件交换机支持VLAN（Virtual LAN）技术，可以将不同的物理端口划分为不同的虚拟局域网，实现逻辑隔离。这样可以提高网络的安全性和管理灵活性。
4. QoS支持：硬件交换机支持QoS（Quality of Service）技术，可以对不同的数据流进行优先级处理，确保关键数据的传输质量。例如，可以将语音、视频等实时流量的优先级设置为高，保证它们的传输质量。
5. 聚合链路支持：硬件交换机支持聚合链路（Link Aggregation）技术，可以将多条物理链路绑定成一条逻辑链路，提高网络带宽和冗余性。在一个聚合链路中，所有物理链路的带宽可以叠加，同时一条物理链路出现故障时，其他链路可以自动接管。
6. 交换机性能：硬件交换机的性能指标包括转发速度、转发延迟、吞吐量、MAC地址表容量等。这些性能指标决定了交换机可以处理的数据流量和延迟要求。

总的来说，硬件交换机是一种高性能、高可靠性的数据通信设备，可以满足大规模网络的需求。





# 交换机相关术语

交换机（Switch）是计算机网络中用于连接多个网络设备并进行数据包转发的设备。以下是交换机相关的一些术语：

1. 端口（Port）：交换机上用于连接网络设备的物理接口。
2. MAC地址（Media Access Control Address）：用于识别网络设备的唯一标识符。
3. VLAN（Virtual LAN）：虚拟局域网，将不同的物理局域网划分成多个虚拟局域网，提高网络安全性和可管理性。
4. STP（Spanning Tree Protocol）：生成树协议，用于防止网络中出现环路，保证数据包不会重复传输。
5. Trunk：交换机上连接不同 VLAN 的端口。
6. 洪泛（Flood）：在网络中，当交换机无法确定数据包应该从哪个端口转发时，会将数据包从所有端口广播发送，这种现象称为洪泛。
7. 速率限制（Rate Limiting）：控制数据流量的一种方式，可以对交换机上的端口或 VLAN 设置不同的速率限制，以控制网络流量。
8. QoS（Quality of Service）：服务质量，用于控制网络中不同类型的数据流量，保证网络中关键的数据（如音视频数据）优先传输。
9. ACL（Access Control List）：访问控制列表，用于控制网络中的访问权限，可以限制某些设备或用户的网络访问。
10. 线速交换（Line-rate Switching）：交换机在不降低数据包速率的情况下进行数据包转发的能力。



## VLAN & VLANIF

### VLAN

在计算机网络概念中，VLAN是“虚拟局域网”（Virtual Local Area Network）的缩写。

VLAN是一种将网络设备（如交换机、路由器等）按照逻辑上的部门或者业务进行划分，使得在物理上相互隔离的网络设备能够通过逻辑上的方式进行连接的技术。通过VLAN技术，管理员可以将网络上的不同设备按照其功能或者所属的部门划分到不同的虚拟局域网中，从而实现部门之间或者功能之间的网络隔离和安全管理。

通过VLAN技术，管理员可以在同一交换机上创建多个虚拟局域网，并在这些虚拟局域网之间进行通信，也可以通过路由器将不同交换机上的虚拟局域网连接起来。这种逻辑上的划分方式可以增加网络的可管理性、可靠性和安全性。



VLAN（Virtual LAN，虚拟局域网）是一种网络技术，通过在物理局域网中进行逻辑划分，将多个不同的物理局域网设备组成一个逻辑上的局域网，使得这些设备可以像在同一个局域网内一样进行通信。

在一个物理局域网内，可以根据不同的需求将其划分成多个VLAN，每个VLAN就像是一个逻辑上独立的局域网，其中的设备只能与同一VLAN内的设备进行通信，而与其他VLAN内的设备则需要通过路由器进行通信。

VLAN通常是通过交换机或路由器来实现的，交换机可以将一个物理端口划分成多个逻辑端口，每个逻辑端口可以隶属于不同的VLAN，路由器则可以连接不同的VLAN，实现不同VLAN之间的通信。使用VLAN可以有效地划分网络，提高网络的可管理性和安全性。





**VLAN 是一种网络协议吗？**

VLAN（Virtual Local Area Network）是一种实现逻辑隔离的网络技术，不是一种协议。VLAN将一个物理局域网划分成多个逻辑子网，不同的子网之间可以通过路由器进行通信，从而增强了网络的安全性和灵活性。VLAN通常使用802.1Q标准进行实现，该标准定义了如何在数据帧中加入VLAN标识信息，从而实现对数据包的分类和隔离。



**不同vlan间的设备通信需要通过路由器，但目前大多数交换机都具有路由器的功能（即三层交换机）**

- 是的，大多数现代网络交换机都支持三层路由功能，这意味着它们可以支持不同VLAN之间的通信，而无需使用独立的路由器。通过在交换机上配置虚拟局域网 (VLAN) 来隔离和管理网络流量，可以提高网络安全性和性能。然而对于大规模的网络，分离路由器和交换机有时可以提供更好的可扩展性和管理性。

 

VLAN是一种将网络设备分组的技术，以实现逻辑上隔离的网络，而不是物理上的隔离。每个VLAN可以被看作是一个独立的逻辑局域网，在该局域网内的设备可以相互通信，而与其他VLAN的设备通信需要进行路由。

VLAN的实现方式有两种：静态VLAN和动态VLAN。静态VLAN需要手动配置，每个端口都被分配到一个固定的VLAN中。动态VLAN则是根据设备的MAC地址或端口所连接的设备自动进行分组。

VLAN有以下几个主要特点：

1. 逻辑隔离：VLAN可以将网络设备逻辑上分成不同的虚拟网络，使得它们可以共享同一个物理网络，但在逻辑上相互隔离，提高了网络的安全性和可管理性。
2. 广播控制：在同一个VLAN内的设备可以相互广播，而不会影响到其他VLAN内的设备。这可以减少广播风暴的影响，提高网络的性能。
3. 安全性：通过VLAN的逻辑隔离，可以将不同的用户或应用程序隔离开来，提高网络的安全性。
4. 灵活性：VLAN可以根据需求进行灵活的配置和管理，方便网络管理员进行管理和调整。

在实际应用中，VLAN可以用于以下几个方面：

1. 隔离部门：不同的部门可以被划分到不同的VLAN中，使得它们之间逻辑上相互隔离，提高网络的安全性和可管理性。
2. 隔离应用：对于需要高度安全性的应用程序，可以将其单独划分到一个VLAN中，避免被其他应用程序干扰。
3. 扩展网络：通过VLAN的配置和管理，可以将多个物理网络扩展成一个更大的虚拟网络，提高网络的可用性和可扩展性。
4. QoS控制：VLAN可以用于控制流量的优先级和质量，使得重要的应用程序可以获得更高的网络带宽和服务质量。

总之，VLAN是一种非常有用的网络技术，它可以提高网络的安全性、可管理性和可扩展性，适用于各种不同的网络环境和应用场景。



### VLANIF

VLANIF是一种虚拟接口，用于连接不同的VLAN，并在不同的VLAN之间提供路由功能。在一个交换机或路由器中，每个VLAN可以分配一个VLANIF接口。VLANIF接口可以看作是连接不同VLAN的虚拟网关，它在不同VLAN之间提供路由功能，从而实现不同VLAN之间的通信。

VLANIF的主要作用是在不同的VLAN之间提供路由功能。当一个设备需要和另一个VLAN中的设备通信时，它可以通过VLANIF接口发送数据包到VLANIF所连接的VLAN中，并在该VLAN中寻找目标设备。如果目标设备不在同一个VLAN中，VLANIF将负责将数据包路由到目标VLAN，并在该VLAN中寻找目标设备。因此，VLANIF可以使得不同VLAN之间的通信变得更加简单和方便。

除了提供路由功能外，VLANIF还可以用于以下几个方面：

1. 虚拟主机：通过配置VLANIF接口，可以创建多个虚拟主机，从而在同一个物理设备上运行多个虚拟操作系统。
2. QoS控制：通过VLANIF接口可以对数据包进行QoS控制，提供更好的服务质量。
3. 安全性：VLANIF可以在不同的VLAN之间提供安全隔离，从而提高网络的安全性。

总之，VLANIF是连接不同VLAN之间的重要组成部分，它可以在不同的VLAN之间提供路由功能，从而实现不同VLAN之间的通信。通过VLANIF接口的配置和管理，可以实现更加灵活和可控的网络管理和应用。



### 两者区别

VLAN和VLANIF是两个不同的概念，它们的区别在于：

1. VLAN是一种虚拟局域网技术，可以将不同的设备分成不同的逻辑分组，使得不同的分组之间可以相互通信，但是不同的分组之间是隔离的，不会互相干扰。而VLANIF是用于连接不同的VLAN之间的虚拟接口，提供不同VLAN之间的路由功能。
2. VLAN是一个逻辑上的概念，而VLANIF是一个实际存在的虚拟接口。在一个交换机或路由器中，每个VLAN可以分配一个VLANIF接口。
3. VLAN通常用于划分网络区域，实现安全隔离和资源管理；而VLANIF则主要用于在不同的VLAN之间提供路由功能，实现不同VLAN之间的通信。

总之，VLAN和VLANIF是两个不同的概念，它们的作用和应用场景也不同。VLAN是用于将不同的设备分组和隔离，实现安全隔离和资源管理；而VLANIF是用于连接不同的VLAN之间的虚拟接口，提供路由功能，实现不同VLAN之间的通信。



### 简述

- VLAN代表虚拟局域网（Virtual Local Area Network），是一种逻辑上将网络设备分成不同广播域的技术。这使得不同的网络设备可以位于同一物理网络中，但它们在逻辑上被划分为不同的虚拟网络，相互之间不会产生干扰。
- VLANIF代表VLAN接口，它是一种虚拟接口，用于将不同VLAN之间进行交互。每个VLAN都可以分配一个VLANIF接口，VLANIF接口在不同VLAN之间提供路由功能。
- 两者的区别在于，VLAN是一个逻辑概念，是将网络设备分成不同广播域的技术，而VLANIF是实际用于连接不同VLAN的接口。VLAN通过划分广播域来实现逻辑隔离，而VLANIF则提供了连接不同VLAN之间的路由功能。



# 交换机物理接口说明

## console 口

### 连接 console 口

console口是计算机设备上的一种物理接口，用于通过串口连接到设备的命令行界面，但是它不能直接提供远程连接的功能。因此，我们需要使用Putty等工具来**建立与计算机设备的串口连接**，从而远程控制设备。Putty通过模拟串口连接，可以实现控制台的命令行界面，并提供类似于本地终端的用户体验，方便管理员进行设备的配置和管理。

除了Putty，还有一些其他的工具可以用于连接串口。以下是一些常用的串口连接工具：

1. SecureCRT：SecureCRT是一款终端仿真软件，可以用于连接串口、Telnet、SSH等协议，提供了丰富的功能和配置选项，支持多标签页、脚本宏、自动登录等功能。
2. TeraTerm：TeraTerm是一款免费的终端仿真软件，支持连接串口、Telnet、SSH等协议，提供了多国语言界面和多种字符集支持，支持自动登录、脚本宏等功能。
3. minicom：minicom是一款Linux下的串口连接工具，支持多种串口参数配置，提供了命令行界面，支持文件传输、脚本录制等功能。
4. HyperTerminal：HyperTerminal是Windows自带的串口连接工具，提供了基本的串口连接功能，支持字符发送和接收、串口参数配置等。
4. xshell6以上也可以

以上这些工具都可以用于连接串口，但在具体选择时，还需要根据自己的实际需求和使用习惯来选择。



### 连接串口相关配置参数

连接串口需要配置以下几个参数：

1. 波特率（Baud rate）：波特率是串行通信中指传输速率的参数，它定义了每秒钟发送的比特数。在连接串口时，波特率要与设备的波特率一致，通常常用的波特率有9600、115200等。
2. 数据位（Data bits）：数据位是指每个字符中有多少位是数据位，通常是8位。
3. 校验位（Parity）：校验位是在串行传输中用来检测传输过程中是否有错误的一种校验方式。常用的校验位有偶校验、奇校验和无校验。如果设备的串口配置了校验位，则在连接时也需要设置相应的校验位。
4. 停止位（Stop bits）：停止位是指在每个字符传输结束后，传输线路保持空闲状态的时间长度。通常常用的停止位有1位和2位。
5. 流控制（Flow control）：流控制用于在串行传输过程中控制数据的流动，常用的流控制方式有硬件流控制和软件流控制。

在使用串口连接工具时，这些参数通常可以在连接界面的设置选项中进行配置。根据设备的串口配置参数来设置连接工具的参数，以确保正常连接和数据传输。



### Putty

使用Putty连接console口需要按照以下步骤进行配置：

1. 打开Putty软件，在“Session”页面中选择“Serial”选项卡。
2. 在“Serial line”输入框中输入串口号，比如COM1、COM2等，具体串口号需要根据设备的实际情况来确定。
3. 在“Speed”输入框中输入波特率，通常常用的波特率有9600、115200等，需要根据设备的串口配置来确定。
4. 在“Connection type”中选择“Serial”。
5. 在“Serial line”下面的“Serial”选项中，根据设备的串口配置来选择数据位、停止位、校验位等参数，一般情况下默认值即可。
6. 点击“Open”按钮，打开连接界面。
7. 在连接界面中，输入用户名和密码等信息，即可进入控制台界面进行操作。

需要注意的是，在使用Putty连接console口之前，需要先确认设备是否支持通过串口进行连接，以及串口号和波特率等参数的设置是否正确。



## trunk口

 交换机的Trunk口是指用于连接不同交换机之间的端口，通过该端口可以实现交换机之间的VLAN信息的传递和交换。下面是Trunk口的一些详解：

1. Trunk口的作用：在不同交换机之间传输多个VLAN的数据，以实现VLAN之间的互通和数据的转发。
2. Trunk口的工作原理：在Trunk口上使用VLAN标记技术，将数据包中的VLAN信息添加到帧头中，在不同的交换机之间传输时保留这些信息，确保数据包能够被正确地路由到目标VLAN。
3. Trunk口的配置：在配置Trunk口时，需要指定使用哪种协议进行VLAN信息的传递和交换，比如802.1Q协议或ISL协议，还需要指定Trunk口所属的VLAN列表。
4. Trunk口的限制：Trunk口能够传输的VLAN数量是有限制的，具体的限制取决于交换机型号和配置，同时需要注意在使用Trunk口时需要避免出现环路。
5. Trunk口的优点：使用Trunk口可以有效地减少网络拓扑复杂度，提高网络的可扩展性和灵活性，同时也能够提高网络的安全性和性能。

**Trunk口是物理接口吗**

是的，Trunk口是交换机的物理接口之一，通常是一种特殊的以太网接口，用于连接不同交换机之间的端口。在这个物理接口上，可以使用不同的协议进行VLAN信息的传递和交换，比如802.1Q协议或ISL协议。通过Trunk口连接的交换机可以实现多个VLAN之间的数据传输和交换，从而提高网络的可扩展性和灵活性。

### 迈普交换机配置 Trunk 口







# 交换机常用指令汇总

- **`enable` 进入特权模式**
- **`configure terminal` 进入全局配置模式（需先进入特权模式）**







## 特权模式

- 需要先使用 `enable` 进入特权模式

以下是一些常用的交换机特权模式下的命令，不同品牌和型号的交换机可能会有所不同，具体命令可以参考相关的操作手册。

```sh
show running-config # 查看当前配置文件的运行状态。
show running-config | include ip address # 查看交换机的IP地址

show ip interface brief # 查看接口的IP地址和状态。



show interfaces # 查看接口状态和统计信息。

show mac-address-table # 查看MAC地址表。
show arp # 查看ARP表。
show cdp neighbors # 查看CDP邻居信息。
show spanning-tree # 查看生成树协议状态信息。
show version # 查看交换机的版本信息。
show log # 查看交换机系统日志信息。
```









## IP管理

### 设置 IP

- 以下是通过VLANIF实现的
- ip address ip-address { network-mask | mask-len }  [ secondary ]

#### 主IP

```sh
# 进入全局配置模式
configure terminal


# interface interface-name，进入接口配置模式，这里进入VLAN 1 接口配置模式
interface vlan 1 


# 设置 IP 地址和子网掩码,x.x.x.x代表需要设置的IP地址，y.y.y.y代表子网掩码。
ip address x.x.x.x y.y.y.y


# 启用接口，可选项，缺省情况下，接口是启用的。
no shutdown


# 退出VLAN 1 接口配置模式
exit
```

#### 次IP

```sh
# 需要加上secondary
ip address 172.16.10.2 255.255.255.0 secondary


# 验证
switch(config-if-vlan1)#show running-config interface vlan 1              
...
interface vlan1
 ip address 172.16.30.199 255.255.255.0
 ip address 172.16.10.2 255.255.255.0 secondary
 exit

```





### 查看 IP

- 方法一

```
show ip interface brief
```

- 方法二

```
enable

show running-config interface vlan 1
```





### 删除 IP

在迈普交换机上删除IP地址，可以使用以下命令：

```
no ip address <IP地址> <子网掩码>
```

此命令需要在接口配置模式下执行，例如：

```
interface vlan 1
no ip address 192.168.1.1 255.255.255.0
```

其中，`vlan 1`是指进入到VLAN 1的接口配置模式，`no ip address`是删除当前接口的IP地址，`192.168.1.1`和`255.255.255.0`是要删除的IP地址和子网掩码。

执行完命令后，需要使用`write`命令将修改保存到交换机配置文件中。



## 路由管理

### 配置静态路由

```
configure terminal

ip route <目标网络地址> <子网掩码> <下一跳地址>

exit
```

- 范例：

```sh
# 配置到目的网络192.168.100.0的出接口为接口VLAN2。
Hostname>enable
Hostname#configure terminal
Hostname(config)#ip route 192.168.100.0 255.255.255.0 vlan2


# 配置到目的网络192.168.100.0的网关地址为192.168.200.1。
Hostname>enable
Hostname#configure terminal
Hostname(config)#ip route 192.168.100.0 255.255.255.0 192.168.200.1


# 配置到目的网络192.168.100.0的网关地址为192.168.200.1，出接口为接口VLAN2。
Hostname>enable
Hostname#configure terminal
Hostname(config)#ip route 192.168.100.0 255.255.255.0 vlan2 192.168.200.1



# 配置到目的网络192.168.100.0的网关地址为192.168.200.1。
switch>enable
switch#configure terminal
switch(config)#ip route 172.16.20.0 255.255.255.0 172.16.10.1
switch(config)#exit
switch#write 
Are you sure to overwrite /flash/startup (Yes|No)?yes
...
switch#show ip route
...
S   172.16.20.0/24 [1/100] via 172.16.10.1, 00:00:10, vlan1 # 验证
...
```



### 查看路由表

```sh
show ip route
```



### 清空路由表

```
clear ip route *
```

### 删除指定路由

```
configure terminal

no ip route <目标网络地址> <子网掩码> <下一跳地址>

exit
```

### 使能路由

```
configure terminal

ip routing

exit
```

### 禁用路由

```
configure terminal

no ip routing

exit
```







## VLAN 管理

### 查看VLAN信息

```
enable

show vlan
```

### 创建VLAN

```sh
enable

configure terminal

vlan 2 # 创建VLAN2

exit
```



### 命令区别

```
switch(config)#vlan 1
switch(config-vlan1)#

switch(config)#interface vlan 1
switch(config-if-vlan1)#
```

这两个命令的区别在于：

1. `vlan 1` 命令创建了一个名为 VLAN 1 的虚拟局域网，该命令进入了 VLAN 1 的配置模式（`config-vlan1`）。在这个模式下，您可以对 VLAN 1 的参数进行配置，比如 VLAN 的名称、VLAN 的 ID 等等。
2. `interface vlan 1` 命令配置了一个 VLANIF 接口，该接口是用于管理 VLAN 1 的虚拟接口。该命令进入了 VLANIF 1 的配置模式（`config-if-vlan1`）。在这个模式下，您可以为 VLANIF 1 配置 IP 地址、开启接口、配置 QoS、绑定 ACL 等等。

总的来说，`vlan` 命令是用于创建 VLAN 的，而 `interface vlan` 命令则是用于配置 VLANIF 接口的。虽然它们都是用于配置 VLAN 的，但是它们的具体作用和配置方式是不同的。





## 保存配置

```
enable

write
```









## 重启交换机

要重启迈普交换机，可以在特权模式下使用命令“reload”，具体步骤如下：

1. 进入特权模式：输入“enable”命令并输入特权密码。
2. 进入全局配置模式：输入“configure terminal”命令。
3. 配置重启参数（可选）：使用“reload”命令可以重启交换机，并且可以选择配置重启参数。例如，“reload in 5”表示5分钟后重启交换机，“reload at 22:00”表示在当天晚上10点重启交换机。
4. 执行重启：使用“reload”命令执行重启操作。
5. 确认操作：在交换机提示是否要保存配置信息时，输入“y”或“yes”确认重启操作并保存配置信息，或输入“n”或“no”取消重启操作并不保存配置信息。

注意：在执行重启操作前，请确保保存了配置信息并已做好备份，避免因为配置信息丢失导致的数据丢失或其他问题。













# 修改交换机密码

### 迈普交换机

首先需通过 console 口登陆

大体流程是，首先按交换机上的RST键，然后重启过程中一直按CTRL+C，之后就能进入到Monitor配置模式，后来就按照官方文档提示的执行 clear startup，执行成功之后执行 reset 重启交换机，最后就可以通过空密码进入到特权模式了











# 端口镜像

交换机端口镜像是指将一个或多个端口的网络流量镜像到另一个端口或监视设备上，以便分析网络流量或监测网络性能。以下是有关交换机端口镜像的详细说明：

1. 镜像源端口：镜像源端口是将要被镜像的端口，它负责将原始数据流复制到目标端口或监视设备上。在许多交换机中，可以选择将一个或多个端口作为镜像源端口。
2. 镜像目标端口：镜像目标端口是接收从镜像源端口复制的数据流的端口。在大多数情况下，目标端口是监视设备，例如网络分析仪（Network Analyzer）或数据包捕获设备（Packet Capture Device）。
3. 镜像方向：镜像方向指定了要复制的流量类型，例如入站（ingress）或出站（egress）流量。在大多数情况下，可以选择镜像一个或多个方向的流量。
4. 镜像类型：有两种类型的镜像：端口镜像和 VLAN 镜像。端口镜像是将单个端口的流量镜像到目标端口或监视设备上，而 VLAN 镜像则是将整个 VLAN 的流量镜像到目标端口或监视设备上。
5. 镜像过滤器：可以使用镜像过滤器来限制镜像的数据流量。镜像过滤器可以基于源或目标 IP 地址、端口号、协议类型或其他网络特征过滤数据流量。
6. 镜像的使用场景：交换机端口镜像广泛用于网络分析和故障排除。它们使网络管理员可以监视网络流量，分析网络问题，并诊断网络故障。例如，网络管理员可以使用交换机端口镜像来监视特定用户的网络流量，以便识别潜在的网络攻击或滥用行为。

总之，交换机端口镜像是一种有用的工具，可以帮助网络管理员监视网络流量、诊断网络问题和解决网络故障。



**深信服的上网行为管理是不是就是基于交换机的端口镜像来实现的？**

深信服的上网行为管理解决方案中，涉及到的技术手段有很多，其中包括基于交换机的端口镜像技术。具体来说，深信服的上网行为管理解决方案可以通过交换机的端口镜像功能，将网络中的流量复制到指定的监控端口上，然后对这些流量进行实时分析和识别，以获取用户的上网行为信息。

除了端口镜像技术，深信服的上网行为管理解决方案还可以使用流量采集器、数据包解码器、流量分析引擎等技术，对网络流量进行实时分析和识别，以获取用户的上网行为信息。此外，深信服还可以利用云端技术，将用户的上网行为信息上传到云端，进行进一步的分析和管理。

综上所述，深信服的上网行为管理解决方案不仅可以基于交换机的端口镜像技术，还可以利用多种技术手段，对网络流量进行实时分析和识别，以获取用户的上网行为信息。



## 迈普交换机

- 迈普交换机配置端口镜像
- 参考文档：
  - MyPower S4220-S4320系列交换机配置手册V5.1.chm -- 网络管理与监控 -- 端口镜像

```co
config terminal

monitor session 1 source interface gi0/2 both

monitor session 1 source interface gi0/6 both

monitor session 1 destination interface gi0/12
```



- 目前

```
config terminal

monitor session 1 source interface gi0/2 both

monitor session 1 source interface gi0/4 both

monitor session 1 source interface gi0/6 both

monitor session 1 source interface gi0/8 both

monitor session 1 destination interface gi0/12
```



- 验证

```SH
# 显示RSPAN VLAN
show monitor rspan-vlan


# 显示SPAN会话配置信息
show monitor session { session-number | all | local | remote | erspan }
```

